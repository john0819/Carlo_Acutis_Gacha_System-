# 🚀 完整启动流程（让别人也能访问）

## 第一步：配置 ngrok（只需配置一次）

### 1.1 注册 ngrok 账号
访问：https://dashboard.ngrok.com/signup
- 免费注册，只需邮箱

### 1.2 获取 authtoken
登录后访问：https://dashboard.ngrok.com/get-started/your-authtoken
- 复制你的 authtoken（一串字符）

### 1.3 配置 authtoken
在终端运行：
```bash
ngrok config add-authtoken YOUR_AUTHTOKEN
```
（将 YOUR_AUTHTOKEN 替换为你复制的 token）

---

## 第二步：启动服务

### 方法一：一键启动（推荐）⭐

```bash
cd /Users/jiangzi/GolangProject/h5Project
chmod +x start_all.sh
./start_all.sh
```

脚本会自动：
1. ✅ 检查并启动 Go 服务器
2. ✅ 启动 ngrok 内网穿透
3. ✅ 显示公网地址

### 方法二：手动启动

**终端1 - 启动服务器：**
```bash
cd /Users/jiangzi/GolangProject/h5Project
go run main.go
```

**终端2 - 启动 ngrok：**
```bash
cd /Users/jiangzi/GolangProject/h5Project
ngrok http 8080
```

---

## 第三步：获取公网地址

ngrok 启动后会显示：
```
Forwarding   https://abc123-xxx-xxx.ngrok-free.app -> http://localhost:8080
```

**复制这个 https 地址**（例如：`https://abc123.ngrok-free.app`）

或者访问控制台查看：http://localhost:4040

---

## 第四步：生成二维码

### 方法一：使用网页工具（推荐）

1. 打开 `generate_qrcode.html` 文件
2. 在输入框中输入：`https://你的ngrok地址/index.html`
   - 例如：`https://abc123.ngrok-free.app/index.html`
3. 点击"生成二维码"
4. 现在任何人都可以扫描这个二维码访问了！

### 方法二：使用在线工具

1. 访问 https://cli.im/
2. 输入地址：`https://你的ngrok地址/index.html`
3. 生成并下载二维码

---

## 第五步：测试

1. 用手机扫描生成的二维码
2. 手机浏览器会自动打开 H5 页面
3. 页面会随机显示一张图片
4. ✅ 成功！现在任何人都可以扫描访问了

---

## 📋 完整流程总结

```
1. 配置 ngrok（只需一次）
   └─> 注册账号 → 获取 authtoken → 运行配置命令

2. 启动服务
   └─> 运行 ./start_all.sh（推荐）
   或手动启动：go run main.go + ngrok http 8080

3. 获取公网地址
   └─> 从 ngrok 输出或 http://localhost:4040 获取

4. 生成二维码
   └─> 打开 generate_qrcode.html → 输入公网地址 → 生成

5. 分享二维码
   └─> 任何人都可以扫描访问了！
```

---

## 🛠️ 常用命令

### 查看服务状态
```bash
# 查看服务器是否运行
lsof -Pi :8080

# 查看 ngrok 是否运行
pgrep -f ngrok

# 查看 ngrok 控制台
open http://localhost:4040
```

### 停止服务
```bash
# 停止所有服务
pkill -f 'ngrok|main.go'

# 或按 Ctrl+C 停止当前进程
```

### 查看日志
```bash
# 服务器日志（如果使用脚本启动）
tail -f server.log

# ngrok 日志（如果使用脚本启动）
tail -f ngrok.log
```

---

## ❓ 常见问题

**Q: ngrok 地址每次重启都会变吗？**
A: 免费版是的。可以购买付费版绑定固定域名。

**Q: 有流量限制吗？**
A: ngrok 免费版有连接数限制，但对于测试和小规模使用足够。

**Q: 速度慢怎么办？**
A: 可以尝试 Cloudflare Tunnel（完全免费，速度较快）：
```bash
brew install cloudflared
./start_cloudflare.sh
```

**Q: 如何让地址固定不变？**
A: 需要 ngrok 付费版，或使用自己的服务器 + frp。

---

## 🎯 快速检查清单

- [ ] ngrok 已安装：`which ngrok`
- [ ] ngrok 已配置：检查 `~/.ngrok2/ngrok.yml` 或运行 `ngrok config check`
- [ ] 服务器正在运行：`lsof -Pi :8080`
- [ ] ngrok 正在运行：`pgrep -f ngrok`
- [ ] 已获取公网地址
- [ ] 已生成二维码
- [ ] 测试扫描成功

